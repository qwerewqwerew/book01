---
title: 13-modify
layout: default
parent: PHP
tags: [admin]
---

---

1. TOC
{:toc}

---

## 참고링크

{: .no_toc}

🔗[완성코드]({{'/assets/img/14.zip'| relative_url}} ){: .anc}

🔗[fopen-php-offical]({{'https://www.php.net/manual/en/function.fopen.php'| relative_url}} ){: .anc}
🔗[fread-php-offical]({{'https://www.php.net/manual/en/function.fread.php'| relative_url}} ){: .anc}
🔗[fread-php-tutorial]({{'https://www.w3schools.com/php/func_filesystem_fread.asp'| relative_url}} ){: .anc}

---

{: .note }
> 게시판 글수정, 조회, update 구현


---
{: .mb-10}
 
# 01-view.php
1. 수정하기 콘텐츠 추가


view.php
{: .label .label-purple }

```html
<p><a href="index.php">메인화면으로 돌아가기</a></p>
<p><a href="index.php">수정하기</a></p>

```

---
{: .mb-10}
 
# 02-update.php

1. write.php 를 다른이름으로 저장 `update.php`
2. 수정

update.php
{: .label .label-purple }

```html
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>글수정</title>
  </head>

  <body>
    <h1>수정하기</h1>
    
    <form action="insert.php" method="post">
      <p>
        <label for="name">작성자:</label>
        <input type="text" id="name" name="name" value="김망고"/>
      </p>
      <p>
        <label for="message">메시지:</label>
        <textarea name="message" id="message" cols="30" rows="10">이전글내용</textarea>
      </p>
      <input type="submit" value="글쓰기" />
    </form>
  </body>
</html>
```
{: .note }
> update에 필요한 기능
> 1. 데이터베이스 접속
> 2. 데이터베이스 조회
> 3. 해당 글 내용 보기
> 위의 내용은 index.php 의 list 내용에서 전달받아서 글을 출력하는 view.php의 상단부와 같다

설명
![]({{'/assets/img/php152.jpg'| relative_url}} )

---

1. view.php의 내용을 복사하여 update.php의 최상단에 붙여넣는다

update.php
{: .label .label-purple }

```php
<?php
$conn = mysqli_connect("localhost", "root", "", "mango_board");

if (!$conn) {
  echo 'db에 연결하지 못했습니다.' . mysqli_connect_error();
} else {
  echo 'db에 접속했습니다!!!';
}
$view_num = $_GET['number'];
$sql = "SELECT * FROM free_board WHERE number = $view_num";
$result = mysqli_query($conn, $sql);
?>
...
```


---
{: .mb-10}
 
# 03-view.php

+ 글내용을 출력하는 코드를 응용하여 작성한다.

view.php
{: .label .label-purple }

```php
...
 <?php
  }
  mysqli_close($conn);
  ?>
  <p><a href="index.php">메인화면으로 돌아가기</a></p>
  <p><a href="update.php?number=<?= $row['number'] ?>">수정하기</a></p>
...
```

---
{: .mb-10}
 
# 04-update.php

![]({{'/assets/img/php153.jpg'| relative_url}} )

1. db에서 조회한 결과를 리턴하는 함수로 form 을 감싼다

```php
<?php
$conn = mysqli_connect("localhost", "root", "", "mango_board");

if (!$conn) {
  echo 'db에 연결하지 못했습니다.' . mysqli_connect_error();
} else {
  echo 'db에 접속했습니다!!!';
}
$view_num = $_GET['number'];
$sql = "SELECT * FROM free_board WHERE number = $view_num";
$result = mysqli_query($conn, $sql);
?>


<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>글수정</title>
</head>

<body>
  <h1>수정하기</h1>
  <?php
  if ($row = mysqli_fetch_array($result)) {
  ?>
    <form action="insert.php" method="post">
      <p>
        <label for="name">작성자:</label>
        <input type="text" id="name" name="name" value=<?= $row['name'] ?> />
      </p>
      <p>
        <label for="message">메시지:</label>
        <textarea name="message" id="message" cols="30" rows="10"><?= $row['message'] ?></textarea>
      </p>
      <input type="submit" value="글쓰기" />
    </form>
  <?php
  }
  mysqli_close($conn);
  ?>

</body>

</html>
```

실행

![]({{'/assets/img/php154.jpg'| relative_url}} )

1. index.php 에서 글목록 클릭
2. 해당글번호로 이동 수정하기 클릭
3. 해당글 조회 수정페이지 이동

---

{: .mb-10}
 
# 05-modify.php

1. insert.php 다른이름으로 저장 =>  `modify.php`